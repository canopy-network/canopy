{
  "ui": {
    "tx": {
      "typeMap": {
        "send": "Send",
        "stake": "Stake",
        "receive": "Receive"
      },
      "typeIconMap": {
        "send": "Send",
        "stake": "Lock",
        "receive": "Download"
      }
    }
  },
  "actions": [
    {
      "id": "send",
      "title": "Send",
      "icon": "Send",
      "relatedActions": [
        "receive"
      ],
      "ui": {
        "slots": {
          "modal": {
            "className": "w-[40rem]"
          }
        }
      },
      "tags": [
        "quick"
      ],
      "form": {
        "fields": [
          {
            "id": "address",
            "name": "address",
            "type": "text",
            "label": "From Address",
            "value": "{{account.address}}",
            "readOnly": true
          },
          {
            "id": "output",
            "name": "output",
            "type": "text",
            "label": "To Address",
            "required": true,
            "length.min": 1,
            "validation": {
              "messages": {
                "required": "Destination address is required",
                "length.min": "Invalid destination address"
              }
            },
            "features": [
              {
                "id": "pasteBtn",
                "op": "paste"
              }
            ]
          },
          {
            "id": "asset",
            "name": "asset",
            "type": "text",
            "label": "Asset",
            "value": "{{chain.displayName}} (Balance: {{formatToCoin<{{ds.account.amount}}>}})",
            "readOnly": true,
            "ds": {
              "account": {
                "account": {
                  "address": "{{account.address}}"
                }
              },
              "__options": {
                "staleTimeMs": 10000,
                "refetchIntervalMs": 20000,
                "refetchOnMount": true,
                "refetchOnWindowFocus": false
              }
            }
          },
          {
            "id": "amount",
            "name": "amount",
            "type": "amount",
            "label": "Amount",
            "required": true,
            "min": 0,
            "max": "{{formatToCoin<{{ds.account.amount}}>}}",
            "validation": {
              "messages": {
                "required": "Amount is required",
                "min": "Amount must be greater than 0",
                "max": "Amount must be less than {{formatToCoin<{{ds.account.amount}}>}} {{chain.denom.symbol}}"
              }
            },
            "help": "Available ",
            "features": [
              {
                "id": "maxBtn",
                "op": "set",
                "field": "amount",
                "value": "{{formatToCoin<{{ds.account.amount - fees.raw.sendFee}}>}}"
              }
            ]
          }
        ],
        "info": {
          "items": [
            {
              "label": "Network Fee",
              "value": "{{formatToCoin<{{fees.raw.sendFee}}>}} {{chain.denom.symbol}}",
              "icon": "Coins"
            },
            {
              "label": "Estimation time",
              "value": "â‰ˆ 20",
              "icon": "Timer"
            }
          ]
        },
        "summary": {
          "title": "Summary",
          "items": [
            {
              "label": "Receiving Address",
              "value": "{{form.address}}"
            },
            {
              "label": "Asset",
              "value": "{{chain.denom.symbol}} (Balance: {{formatToCoin<{{ds.account.amount}}>}})"
            }
          ]
        },
        "confirmation": {
          "title": "Confirmations",
          "summary": [
            {
              "label": "From",
              "value": "{{shortAddress<{{account.address}}>}}"
            },
            {
              "label": "To",
              "value": "{{shortAddress<{{form.output}}>}}"
            },
            {
              "label": "Amount",
              "value": "{{numberToLocaleString<{{form.amount}}>}} {{chain.denom.symbol}}"
            },
            {
              "label": "Fee",
              "value": "{{formatToCoin<{{fees.amount}}>}} {{chain.denom.symbol}}"
            }
          ],
          "btn": {
            "icon": "Send",
            "label": "Send"
          }
        }
      },
      "payload": {
        "address": {
          "value": "{{account.address}}",
          "coerce": "string"
        },
        "output": {
          "value": "{{form.output}}",
          "coerce": "string"
        },
        "amount": {
          "value": "{{toBaseDenom<{{form.amount}}>}}",
          "coerce": "number"
        },
        "delegate": {
          "value": false,
          "coerce": "boolean"
        },
        "earlyWithdrawal": {
          "value": false,
          "coerce": "boolean"
        },
        "pubKey": {
          "value": "",
          "coerce": "string"
        },
        "committees": {
          "value": "",
          "coerce": "string"
        },
        "signer": {
          "value": "",
          "coerce": "string"
        },
        "memo": {
          "value": "{{form.memo}}",
          "coerce": "string"
        },
        "fee": {
          "value": "{{fees.raw.sendFee}}",
          "coerce": "number"
        },
        "submit": {
          "value": true,
          "coerce": "boolean"
        },
        "password": {
          "value": "{{session.password}}",
          "coerce": "string"
        }
      },
      "submit": {
        "base": "admin",
        "path": "/v1/admin/tx-send",
        "method": "POST"
      },
      "notifications": {
        "onSuccess": {
          "variant": "success",
          "title": "Send!",
          "description": "{{result}}",
          "actions": [
            {
              "type": "link",
              "label": "Explorer",
              "href": "{{chain.explorer.tx}}/{{result}}",
              "newTab": true
            }
          ]
        }
      }
    },
    {
      "id": "receive",
      "title": "Receive",
      "icon": "Scan",
      "relatedActions": [
        "send"
      ],
      "ui": {
        "variant": "modal",
        "icon": "Send",
        "slots": {
          "modal": {
            "className": "w-[20rem]"
          }
        }
      },
      "tags": [
        "quick"
      ],
      "form": {
        "layout": {
          "aside": {
            "show": true,
            "width": "w-[10rem]"
          }
        },
        "fields": [
          {
            "id": "address",
            "name": "address",
            "type": "text",
            "label": "Receiving Address",
            "value": "{{account.address}}",
            "readOnly": true,
            "features": [
              {
                "id": "copyBtn",
                "op": "copy",
                "from": "{{account.address}}"
              }
            ]
          },
          {
            "id": "asset",
            "name": "asset",
            "type": "text",
            "label": "Asset",
            "value": "{{chain.denom.symbol}} (Balance: {{formatToCoin<{{ds.account.amount}}>}})",
            "readOnly": true,
            "ds": {
              "account": {
                "account": {
                  "address": "{{account.address}}"
                }
              },
              "__options": {
                "staleTimeMs": 10000,
                "refetchIntervalMs": 20000,
                "refetchOnMount": true,
                "refetchOnWindowFocus": false
              }
            }
          }
        ],
        "info": {
          "title": "Details",
          "items": [
            {
              "label": "Only send {{chain.denom.symbol}} to this address.",
              "icon": "Coins"
            },
            {
              "label": "Allow 20 seconds for confirmation.",
              "icon": "Timer"
            }
          ]
        }
      }
    },
    {
      "id": "stake",
      "title": "Stake",
      "icon": "Lock",
      "ui": {
        "slots": {
          "modal": {
            "style": {
              "minWidth": "34rem",
              "maxWidth": "40rem",
              "width": "33vw"
            }
          }
        }
      },
      "tags": [
        "quick"
      ],
      "form": {
        "wizard": {
          "steps": [
            {
              "id": "setup",
              "title": "Setup"
            },
            {
              "id": "committees",
              "title": "Committees"
            }
          ]
        },
        "fields": [
          {
            "id": "operator",
            "span": {
              "base": 12
            },
            "name": "operator",
            "type": "advancedSelect",
            "allowFreeInput": true,
            "allowCreate": true,
            "label": "Staking (Operator) Address",
            "placeholder": "Select Staking Address",
            "map": "{{ Object.keys(ds.keystore?.addressMap || {})?.map(k => ({ label: k.slice(0, 6) + \"...\" + String(k ?? \"\")?.slice(-6) + ' (' + ds.keystore.addressMap[k].keyNickname +') ' , value: k }))}}",
            "ds": {
              "keystore": {},
              "__options": {
                "staleTimeMs": 300000,
                "gcTimeMs": 600000,
                "refetchOnMount": false,
                "refetchOnWindowFocus": false
              }
            },
            "step": "setup"
          },
          {
            "id": "output",
            "span": {
              "base": 12
            },
            "name": "output",
            "type": "advancedSelect",
            "allowFreeInput": true,
            "allowCreate": true,
            "label": "Rewards Address",
            "placeholder": "Select Rewards Address",
            "value": "{{ ds.validator ? ds.validator.output : '' }}",
            "map": "{{ Object.keys(ds.keystore?.addressMap || {})?.map(k => ({ label: k.slice(0, 6) + \"...\" + String(k ?? \"\")?.slice(-6) + ' (' + ds.keystore.addressMap[k].keyNickname +') ' , value: k }))}}",
            "ds": {
              "keystore": {},
              "__options": {
                "staleTimeMs": 300000,
                "gcTimeMs": 600000,
                "refetchOnMount": false,
                "refetchOnWindowFocus": false
              }
            },
            "step": "setup"
          },
          {
            "id": "signerResponsible",
            "name": "signerResponsible",
            "type": "option",
            "label": "Signer Address",
            "required": true,
            "inLine": true,
            "borders": false,
            "options": [
              {
                "label": "Operator",
                "value": "operator",
                "help": "Staked Address"
              },
              {
                "label": "Reward",
                "value":  "reward",
                "help": "Output Address"
              }
            ],
            "step": "setup"
          },
          {
            "id": "_validatorLoader",
            "name": "_validatorLoader",
            "type": "text",
            "showIf": "{{ false }}",
            "ds": {
              "validator": {
                "account": {
                  "address": "{{form.signerResponsible === 'operator' ? form.operator : form.output}}"
                },
                "__options": {
                  "enabled": "{{ form.signerResponsible && (form.signerResponsible === 'operator' ? form.operator : form.output) }}",
                  "staleTimeMs": 0,
                  "refetchIntervalMs": 20000,
                  "watch": ["form.signerResponsible", "form.operator", "form.output"],
                  "refetchOnWindowFocus": false
                }
              }
            },
            "step": "setup"
          },
          {
            "id": "asset",
            "name": "asset",
            "type": "dynamicHtml",
            "html": "<div class='flex-col col-span-12 p-4 bg-bg-primary rounded-lg'><h4 class='text-canopy-50 text-md mb-2'>Signer Address Information</h4><div class='flex justify-between'><div class='flex-col'><p class='text-text-muted text-sm'>Liquid:</p><p class='text-canopy-50 font-semibold'>{{formatToCoin<{{ds.account.amount ?? 0}}>}} {{chain.denom.symbol}}</p></div><div class='flex-col'><p class='text-text-muted text-sm'>Staked:</p><p class='text-canopy-50 font-semibold'>{{formatToCoin<{{ds.validator.stakedAmount ?? 0}}>}} {{chain.denom.symbol}}</p></div><div class='flex-col'><p class='text-text-muted text-sm'>Committees:</p><p class='text-canopy-50 font-semibold'>{{ds.validator.committees ?? 'N/A'}}</p></div></div></div>",
            "showIf": "{{ form.signerResponsible && form.operator && form.output }}",
            "ds": {
              "account": {
                "account": {
                  "address": "{{form.signerResponsible === 'operator' ? form.operator : form.output}}"
                },
                "__options": {
                  "enabled": "{{ form.signerResponsible && (form.signerResponsible === 'operator' ? form.operator : form.output) }}",
                  "staleTimeMs": 0,
                  "refetchIntervalMs": 20000,
                  "watch": ["form.signerResponsible", "form.operator", "form.output"],
                  "refetchOnWindowFocus": false
                }
              }
            },
            "step": "setup",
            "span": { "base": 12 }
          },
          {
            "id": "amount",
            "name": "amount",
            "type": "amount",
            "placeholder": "0.00",
            "label": "Amount",
            "value": "{{ ds.validator ? formatToCoin<{{ds.validator.stakedAmount}}> : params.networkParams.validator.minimumOrderSize }}",
            "required": true,
            "min": 0,
            "max": "{{formatToCoin<{{ds.account.amount}}>}}",
            "validation": {
              "messages": {
                "min": "Minimum you can send is {{min}} {{chain.denom.symbol}}",
                "max": "You cannot send more than your balance {{numberToLocaleString<{{max}}>}} {{chain.denom.symbol}}"
              }
            },
            "features": [
              {
                "id": "max",
                "op": "set",
                "field": "amount",
                "value": "{{formatToCoin<{{ds.account.amount - fees.raw.stakeFee}}>}}"
              }
            ],
            "span": {
              "base": 12
            },
            "step": "setup"
          },
          {
            "id": "isDelegate",
            "name": "isDelegate",
            "type": "optionCard",
            "label": "Stake Type",
            "required": true,
            "value": "{{ ds.validator ? ds.validator.delegate : false }}",
            "options": [
              {
                "label": "Validation",
                "value": false,
                "help": "Run your own validator",
                "toolTip": "This will run your own validator on the network."
              },
              {
                "label": "Delegation",
                "value":  true,
                "help": "Delegate to committee",
                "toolTip": "This will delegate your tokens to a committee."
              }
            ],
            "step": "setup"
          },
          {
            "id": "isAutocompound",
            "name": "isAutocompound",
            "type": "switch",
            "help": "Automatically restake rewards",
            "label": "Autocompound",
            "value": "{{ ds.validator ? ds.validator.compound : false }}",
            "step": "setup"
          },

          {
            "id": "selectCommittees",
            "name": "selectCommittees",
            "type": "tableSelect",
            "label": "Select Committees",
            "required": true,
            "help": "Select committees you want to delegate to.",
            "validation": {
              "messages": {
                "required": "Please select at least one committee"
              }
            },
            "multiple": true,
            "rowKey": "id",
            "selectMode": "action",
            "value": "{{ ds.validator?.committees ?? [] }}",
            "rows": [
              { "id": 1, "name": "Canopy", "minStake": "1 CNPY" },
              { "id": 2, "name": "Canary", "minStake": "1 CNPY" }

            ],
            "columns": [
              {
                "title": "Committee",
                "type": "committee",
                "align": "left"
              },
              {
                "key": "stakedAmount",
                "title": "Staked Amount",
                "expr": "{{ ds.validator?.committees?.includes(row.id) ? formatToCoin<{{ds.validator.stakedAmount}}> + ' ' + chain.denom.symbol : '0 ' + chain.denom.symbol }}",
                "align": "left",
                "className": "text-emerald-400 font-medium"
              }
            ],
            "rowAction": {
              "title": "Action",
              "label": "Stake",
              "emit": {
                "op": "select"
              }
            },
            "step": "committees"
          },


          {
            "id": "manualCommittees",
            "name": "manualCommittees",
            "type": "text",
            "label": "Committees Summary",
            "placeholder": "1,2,3",
            "help": "Enter comma separated committee ids",
            "value": "{{form.selectCommittees.filter(c => c !== '').map(c => c).join(',')}}",
            "step": "committees"
          },
          {
            "id": "validatorAddress",
            "name": "validatorAddress",
            "type": "text",
            "label": "Validator Address",
            "required": true,
            "showIf": "{{ form.isDelegate && form.isDelegate != 'true' }}",
            "placeholder": "tcp://127.0.0.1:xxxx",
            "help": "Put the url of the validator you want to delegate to.",
            "step": "committees"
          },
          {
            "id": "txFee",
            "name": "txFee",
            "type": "amount",
            "label": "Transaction Fee",
            "value": "{{formatToCoin<{{fees.raw.stakeFee}}>}}",
            "suffix": "{{chain.denom.symbol}}",
            "step": "committees"
          }
        ],
        "confirmation": {
          "title": "Confirmations",
          "summary": [
            {
              "label": "Staking Address",
              "value": "{{shortAddress<{{account.address}}>}}"
            },
            {
              "label": "Stake Amount",
              "value": "{{numberToLocaleString<{{form.amount}}>}} {{chain.denom.symbol}}"
            },
            {
              "label": "Stake Type",
              "value": "{{form.isDelegate ? 'Delegation' : 'Validation'}} {{form.isAutocompound ? 'with autocompounding' : ''}}"
            },
            {
              "label": "Committees IDs",
              "value": "{{form?.selectCommittees?.filter(c => c !== '').map(c => c).join(',')}}"
            },
            {
              "label": "Rewards Address",
              "value": "{{shortAddress<{{form.output}}>}}"
            },
            {
              "label": "Transaction Fee",
              "value": "{{formatToCoin<{{fees.raw.stakeFee}}>}} {{chain.denom.symbol}}"
            }
          ],
          "btns": {
            "submit": {
              "icon": "Lock",
              "label": "Stake"
            }
          }
        }
      },
      "payload": {
        "address": {
          "value": "{{account.address}}",
          "coerce": "string"
        },
        "netAddress": {
          "value": "{{form?.isDelegate && form?.isDelegate != 'true' ? form.validatorAddress : ''}}",
          "coerce": "string"
        },
        "amount": {
          "value": "{{toBaseDenom<{{form.amount}}>}}",
          "coerce": "number"
        },
        "delegate": {
          "value": "{{form.isDelegate}}",
          "coerce": "boolean"
        },
        "earlyWithdrawal": {
          "value": "{{form.isAutocompound}}",
          "coerce": "boolean"
        },

        "committees": {
          "value": "{{form?.selectCommittees?.filter(c => c !== '').map(c => c).join(',')}}}",
          "coerce": "string"
        },
        "signer": {
          "value": "{{form.signerResponsible === 'operator' ? form.operator : form.output}}",
          "coerce": "string"
        },
        "memo": {
          "value": "",
          "coerce": "string"
        },
        "fee": {
          "value": "{{fees.raw.sendFee}}",
          "coerce": "number"
        },
        "submit": {
          "value": true,
          "coerce": "boolean"
        },
        "password": {
          "value": "{{session.password}}",
          "coerce": "string"
        }
      },
      "submit": {
        "base": "admin",
        "path": "/v1/admin/tx-stake",
        "method": "POST"
      },
      "notifications": {
        "onSuccess": {
          "variant": "success",
          "title": "Send!",
          "description": "{{result}}",
          "actions": [
            {
              "type": "link",
              "label": "Explorer",
              "href": "{{chain.explorer.tx}}/{{result}}",
              "newTab": true
            }
          ]
        }
      }
    }
  ]
}
